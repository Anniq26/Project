{"ast":null,"code":"import React,{useState,useEffect}from'react';import ImageInput from'../components/ImageInput';import MBURegForm from'../components/MBURegForm';import styles from'../madebyustyles.module.css';import{createEntry,readEntries,updateEntry}from'../api';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const MadeByUPage=()=>{const[formData,setFormData]=useState({fullName:'',phoneNumber:'',address:'',image:null});const[entries,setEntries]=useState([]);const[editIndex,setEditIndex]=useState(null);const navigate=useNavigate();useEffect(()=>{fetchEntries();},[]);const fetchEntries=async()=>{try{const data=await readEntries();if(Array.isArray(data)){setEntries(data);}else{console.error('API response is not an array:',data);}}catch(error){console.error('Failed to fetch entries:',error);}};const handleFormDataChange=e=>{const{name,value}=e.target;setFormData({...formData,[name]:value});};const handleImageChange=file=>{setFormData({...formData,image:file});};const handleSubmit=async e=>{e.preventDefault();const data=new FormData();data.append('fullName',formData.fullName);data.append('phoneNumber',formData.phoneNumber);data.append('address',formData.address);if(formData.image){data.append('image',formData.image);}try{if(editIndex!==null){await updateEntry(entries[editIndex].id,data);}else{await createEntry(data);}setFormData({fullName:'',phoneNumber:'',address:'',image:null});setEditIndex(null);fetchEntries();navigate('/registered');}catch(error){console.error('Failed to submit form:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:styles.madebyu,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.inputs,children:[/*#__PURE__*/_jsx(ImageInput,{onImageChange:handleImageChange}),/*#__PURE__*/_jsx(MBURegForm,{formData:formData,onFormDataChange:handleFormDataChange,entries:entries,setEditIndex:setEditIndex})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.mbubtnwrp,children:/*#__PURE__*/_jsx(\"button\",{className:styles.mbubutton,onClick:handleSubmit,children:editIndex!==null?'განახლება':'გაგზავნა'})})]});};export default MadeByUPage;","map":{"version":3,"names":["React","useState","useEffect","ImageInput","MBURegForm","styles","createEntry","readEntries","updateEntry","useNavigate","jsx","_jsx","jsxs","_jsxs","MadeByUPage","formData","setFormData","fullName","phoneNumber","address","image","entries","setEntries","editIndex","setEditIndex","navigate","fetchEntries","data","Array","isArray","console","error","handleFormDataChange","e","name","value","target","handleImageChange","file","handleSubmit","preventDefault","FormData","append","id","className","madebyu","children","inputs","onImageChange","onFormDataChange","mbubtnwrp","mbubutton","onClick"],"sources":["C:/Users/ygdra/OneDrive/Desktop/js project/Project/my-app/src/pages/MadeByUPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport ImageInput from '../components/ImageInput';\r\nimport MBURegForm from '../components/MBURegForm';\r\nimport styles from '../madebyustyles.module.css';\r\nimport { createEntry, readEntries, updateEntry } from '../api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst MadeByUPage = () => {\r\n    const [formData, setFormData] = useState({\r\n        fullName: '',\r\n        phoneNumber: '',\r\n        address: '',\r\n        image: null,\r\n    });\r\n    const [entries, setEntries] = useState([]);\r\n    const [editIndex, setEditIndex] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        fetchEntries();\r\n    }, []);\r\n\r\n    const fetchEntries = async () => {\r\n        try {\r\n            const data = await readEntries();\r\n            if (Array.isArray(data)) {\r\n                setEntries(data);\r\n            } else {\r\n                console.error('API response is not an array:', data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch entries:', error);\r\n        }\r\n    };\r\n\r\n    const handleFormDataChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData({ ...formData, [name]: value });\r\n    };\r\n\r\n    const handleImageChange = (file) => {\r\n        setFormData({ ...formData, image: file });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        const data = new FormData();\r\n        data.append('fullName', formData.fullName);\r\n        data.append('phoneNumber', formData.phoneNumber);\r\n        data.append('address', formData.address);\r\n        if (formData.image) {\r\n            data.append('image', formData.image);\r\n        }\r\n\r\n        try {\r\n            if (editIndex !== null) {\r\n                await updateEntry(entries[editIndex].id, data);\r\n            } else {\r\n                await createEntry(data);\r\n            }\r\n            setFormData({ fullName: '', phoneNumber: '', address: '', image: null });\r\n            setEditIndex(null);\r\n            fetchEntries();\r\n            navigate('/registered');\r\n        } catch (error) {\r\n            console.error('Failed to submit form:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.madebyu}>\r\n            <div className={styles.inputs}>\r\n                <ImageInput onImageChange={handleImageChange} />\r\n                <MBURegForm formData={formData} onFormDataChange={handleFormDataChange} entries={entries} setEditIndex={setEditIndex} />\r\n            </div>\r\n            <div className={styles.mbubtnwrp}>\r\n                <button className={styles.mbubutton} onClick={handleSubmit}>\r\n                    {editIndex !== null ? 'განახლება' : 'გაგზავნა'}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MadeByUPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}